<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1">

  
  
  <link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
  

  
  <title>Shell&#39;s Home</title>

  
  
  <link rel="stylesheet" href="http://blog.shell909090.org/css/hugo-octopress.css">

  
  

  
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">

  
  <link href="http://blog.shell909090.org/favicon.png" rel="icon">

  
  
  

  <link href="http://blog.shell909090.org/index.xml" rel="alternate" type="application/rss+xml" title="Shell&#39;s Home" />

  <meta name="description" content="">
  <meta name="keywords" content="">

  <meta name="author" content="Shell Xu">

  
  <meta name="generator" content="Hugo 0.26" />

  
  
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-48816091-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>


</head>
<body>


<header role="banner"><hgroup>
  
  <h1><a href="http://blog.shell909090.org/">Shell&#39;s Home</a></h1>
    <h2></h2>
</hgroup></header>


<nav role="navigation">

<ul class="main-navigation">
  
  
</ul>


<ul class="subscription">
  

</ul>


</nav>


<div id="main">
 <div id="content">
  <div class="blog-index">
    
    
    <article>

        
        

<header>
    <p class="meta">Jul 7, 2005
         - 1 minute read 
         - <a href="http://blog.shell909090.org/blog/archives/186/#disqus_thread">Comments</a>

        
    </p>
    <h1 class="entry-title">
        <a href="http://blog.shell909090.org/blog/archives/186/">毕设答辩</a>
    </h1>
</header>


        
          <p>好久没写blog了。其实不是没写，而是都更新堆在了一个项下面。就是那个NTFS格式解析那个，回头还要继续看，新出一个项吧。
今天下午三点答辩，目前还有两个半小时（注意，不是两个“半小时”）。我不知道别人在答辩前面干些啥，不过我觉得很无聊。资料准备好了，演示和示例代码做好了，文档写的差不多了，就差N臭N长N烦琐的引用列表。我还特定找了个秒表（杀鸡用牛刀？）测了PPT的讲解时间，预期是十分钟。如果加上支线和突发，可以到十五到二十分钟。很好，偶很满意，然后呢？
突然发现，同学一个个都已经有确定的将来，只有偶还在这里迷茫。今天下午的答辩应该是过的去了（至少我没有听说答辩做了还过不去的……），补考也都合格了（嘿嘿，特别感谢马师姐）。还有呢？我的毕业手续也应该要办了。虽然烦琐点，但是总是要过去的。然后呢？
我不知道我将来准备干吗？读研和出国肯定不考虑的了。我不喜欢本系相关的研究生，出国到是可以读计算机，可惜我的英文差到在国外生存都是一个奇迹。这样的英文还在玩电脑，想必是一个更了不得的奇迹吧。那么我准备找工作吗？北京上海？什么类型？怎么发展？我统统不知道。
目前我的生活就是做一天和尚撞一天钟。如果这个和尚突然发现钟被偷了呢？他是找个木鱼来敲？找人重新弄个钟出来？还是还俗？我也不知道。不过我知道，我做和尚的岁月永远的过去了。那不闻窗外事，只读圣贤书的岁月过去了。那单纯无忧，自由自在的时光过去了。我们都要还俗，投身到俗世浊流中，直到死亡将我们带出。</p>

          

        

    </article>
    
    <article>

        
        

<header>
    <p class="meta">Jul 3, 2005
         - 2 minute read 
         - <a href="http://blog.shell909090.org/blog/archives/185/#disqus_thread">Comments</a>

        
    </p>
    <h1 class="entry-title">
        <a href="http://blog.shell909090.org/blog/archives/185/">实践NTFS格式解析</a>
    </h1>
</header>


        
          <p>刚刚在想NTFS格式的问题，感叹没有个实例拿来看看。然后在看小说的时候不知道怎么回事，想到点子上了。不由骂自己白痴，这个问题其实早就解决了阿。直接用CreateFile去读[\.c]():文件不就好了……
OK，明天写个程序看看NTFS的实质……也许还有别的用途，再说了。
另外写个想法，也许NTFS中很多MFT表项没有被某个目录引用成为文件，而其引用计数大于一（这样会被chkdsk查出来吗？等于0会吗？会删除吗？表问咯，偶都不知道……）。这样就会造成系统空间的神秘减少。例如上次系统文件复制时候空出来的硬盘，上面全空，但是使用了400M多的空间。估计就是这么搞出来的。具体要察看chkdsk的机理才知道，因为偶的硬盘经常chkdsk的。如果是属于能查的出来的错误，肯定就不会延迟到换硬盘才发现。可能是chkdsk不检查这个……
另外回头准备看看内核的机制，试试记录或者反木马能不能提前挂在内核态上……嘿嘿，里席必争，咏春的要诀……
这次仔细看了MFT的格式。有点心得，先写下来。
首先是从MBR定位到每个BOOT区的BPB，这样才可以获得BPB中的\$MFT和\$MFTMirr的LCN。并且会获得卷因子（多数都是0x08吧，4k的簇）。\$MFT的LCN多数是4，定位就是32(0x20)。而后就会定位到MFT表上去。
MFT的表项分析起来是遵循链式结构的，不过为什么有那么好的性能和抗崩溃能力呢？可能在于USN和LSN吧。每个表项有个头部（详细看linux的ntfs/layout.h去），指明了大小，关联了相关MFT表项和上下MFT表项，以及这个MFT表项的全局属性。由其中可以引出首个属性的相对偏移。
每个属性都有个公用的属性头部，这个头部说明了属性的类型和大小，还有属性是否直接存储，如何存储等等信息。由上个属性可以推知下个属性偏移，所以属性应该是链式存储的。不知道这里是否具有超长链溢出的问题（长度超过最大值的一半）。
另外，在文件名称属性中具有引用目录项目，所以上面猜测的可能无法成立。不过引用目录和硬连接是违背的阿……下次再分析好了，困了困了……
OK,继续分析。根据刚刚的阅读，一个文件可以分散在多个MFT中，而后就会引入一个叫attribute
list的属性。这个属性指明了每个属性属于那个MFT引用中。其中VCN的换算关系比较特别，基本MFT算-1，下面依次排开，扩展MFT也算进去的。似乎一个MFT就算一簇。不过VCN和LCN的映射关系让我头痛了半个钟头，最后也没有在linux的头文件中找到。到是在NTFS.com中文件恢复上找到了说明。原文如下：
00012580 2E 00 70 00 70 00 74 00 80 00 00 00 48 00 00 00 ..p.p.t.Ђ...H... 00012590 01 00 00 00 00 00 04 00 00 00 00 00 00 00 00 00 ................ 000125A0 6D 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 m.......@....... 000125B0 00 DC 00 00 00 00 00 00 00 DC 00 00 00 00 00 00 .</p>

          
              <footer>
                  <a href="http://blog.shell909090.org/blog/archives/185/" rel="full-article">Read On &rarr;</a>
              </footer>
          

        

    </article>
    
    <article>

        
        

<header>
    <p class="meta">Jul 3, 2005
         - 1 minute read 
         - <a href="http://blog.shell909090.org/blog/archives/184/#disqus_thread">Comments</a>

        
    </p>
    <h1 class="entry-title">
        <a href="http://blog.shell909090.org/blog/archives/184/">COM运作机理初探</a>
    </h1>
</header>


        
          <p> 今天偶看本COM的书，七搞八搞还是没有太搞明白COM的机理。先把看的差不多的写出来好了，省得下次忘记了。也不一定对，整理整理思路继续学……   COM在运行的时候有一个GetClassObject的导出函数，由这个函数负责生成对象实例并且返回合适的接口。所谓接口，就是派生于一些特定的基类的纯虚类。GetClassObject先构造某个类的实例（根据UUID），然后再获得这个类中的某个IUnknown派生接口，再向这个接口查询其他接口实例（又是根据UUID），这个查询函数名字就是QueryInterface。   根据MSDN的资料显示，QueryInterface具备三个理由。一个是每个接口都要 **** Identity，二是在对象实例中的接口集必须静态，三是每个接口都要能够查询到别的在同个对象实例中的接口。三还跟了很多例子，必须成功等等的。   同样从IUnknown中继承的还有Release和AddRef。每次引用一个接口都会有计数变化，这形成了接口的创立和析构。感觉上这个很类似于iNode和MFT中的引用计数，以及dll载入中的使用计数。   简单来说COM的机理上大致就是。通过GetClassObject寻找并且产生合适的对象实例。通过GetClassObject给出的接口QueryInterface返回其他接口。由于每个对象实例中QueryInterface都是自行编写的，所以可以轻易返回其他所有对象接口。于是通过一对UUID可以定位到某个特定的Interface，用C++术语说就是纯虚基类。  </p>

          

        

    </article>
    
    <article>

        
        

<header>
    <p class="meta">Jun 27, 2005
         - 1 minute read 
         - <a href="http://blog.shell909090.org/blog/archives/183/#disqus_thread">Comments</a>

        
    </p>
    <h1 class="entry-title">
        <a href="http://blog.shell909090.org/blog/archives/183/">纪念偶可怜的硬盘</a>
    </h1>
</header>


        
          <p>今天偶的硬盘坏了，感觉是……终于坏了阿。嘿嘿……
偶的硬盘从两年前就开始不好了。其实也没啥好奇怪的，一天二十四小时工作，工作量奇大，天天拖BT。而且还没有好位置，都是用电源线悬挂利于散热（偶用双硬盘的）。能好的了才奇怪了。
不过这个硬盘也算比较奇怪的了，我在服务器上工作的硬盘还没有坏，他先去了。按说服务器上的硬盘无论工时还是工量都比较大，但是却坚持不坏。工作站养护的还算不错，但是又死机又坏硬盘的……看来下次这家DIY公司不能去。（还去啥，都关门了）
两年前，偶的硬盘经常可以听到敲击声，伴随服务器假死状态（整体挂在这个点状态上了）。同时某些部分的数据有CRC错误，读取这个数据时就会引发上述状态。于是偶按照坏区处理，先将整个硬盘格FAT32，重格NTFS，然后重分。将最容易引发的地方分离，然后Copy中等文件，将引发错误的文件保留。于是整理出一个还可以用的硬盘，勉强度日两年。
就在前些日子，偶机器从学校永久的带回家来。由于容易引发死机，所以整个机器经常就裸露在外，利于散热。恐怕加速了硬盘的老化。在一次Copy了大量的ED数据上去准备做压缩的时候（偶好容易从ED上拖下来的阿），硬盘突然狂响。重起后继续响，并且兰屏，再重起……没有了。硬盘整个从系统里面消失了，BIOS都找不到硬盘。看来是硬件电路一起废物了，彻底没救了。
算了算了，反正最近下ED+BT，下的我的硬盘小的要死，正想换个新的。新买个120G的得了。原来我是两个40G分别在两个电脑上，后来貌似就因为这个硬盘不稳定，所以买了个新的硬盘放在WorkStation上。然后Server为了扩容，又添加了一个80G。于是形成了惊人的双电脑双硬盘。然后今天在WorkStation上报废了一个SecondaryDisk40G。所以我买了一个希捷120G放到了Server上面，将原来最初40G的SecondaryDisk（最初是Server的PrimeryDisk）上面的数据移动过去，重新组织了下。和新的80G组成200G服务器双硬盘组，两个都是新的。WorkStation上面换上一个原来的40G作为SecondaryDisk，重新形成80G双硬盘。这样两边都比较稳定，没有大变动。
然后两边都是数据狂移动（40G的数据换位花了我两个钟头，平均数据传输速度是6M/s，实在慢了点，用我自己写的高速移动程序又不放心，嘿嘿，还没有测试完呢）。又重新整理所有硬盘（总算有空间了），打系统补丁（老死机），升级杀毒，整理系统。整整忙了一个晚上，总算将整个系统稳定了下来。
哎，好久没做系统维护的动作了，真的很不适应。八百伴电脑商场搬地方了，新的商家愣是没找到。维护上也头痛的要死……都记不起来了。最头痛的是我多了700的外债，目前已经达到2200，足足是将来三个月的薪水（当然，要吃饭先的）。不过无论怎么叹，硬盘也是回不来了，就像过去一般。所谓永恒和稳定只是虚无的东西，谨以此文纪念我的硬盘。
呜呼，尚觞。</p>

          

        

    </article>
    
    <article>

        
        

<header>
    <p class="meta">Jun 25, 2005
         - 1 minute read 
         - <a href="http://blog.shell909090.org/blog/archives/182/#disqus_thread">Comments</a>

        
    </p>
    <h1 class="entry-title">
        <a href="http://blog.shell909090.org/blog/archives/182/">撑死我了……</a>
    </h1>
</header>


        
          <p>今天真是忙碌，闵行到处跑。
先是答应了参加初中同学聚会，然后早上匆匆爬起来，坐两钟头车跑到闵行。结果据说中午不聚会了，我哭……
幸好班上同学正好有聚会，四个还没有请客的集体请客，去“小尾羊”撮顿好的。前几天在学院里面撮的够厉害的了，后来又跑KaKa家，实在撑的厉害。幸好在家一天消化了不少，撮就撮。于是跑到小尾羊去撮了顿赞的。然后席间小方跑过来问我有个师姐要请教问题（嘿嘿嘿嘿……我伟大吧），他已经同意了，问有时间吗？我说可以啊。后来小方说我运筹补考就是这个师姐代替监考和批阅，所以直接替我答应了，希望不要生气云云……
靠，我生啥气啊。简直是拯救我于危难中。哈哈，谢谢小方，谢谢陈峰，谢谢蒋祖华。马师姐，您爱问啥就问啥。保证知无不言，言无不尽，不知道的回去给你查。请教绝对不感当，只要你不当我就行……So两点多撮完后，跑到东食，解答师姐的问题。实在很简单哎，只是如何使用的问题。不过模型建不上去让我比较糗，有功夫问问KaKa好了。
解答完毕已经快四点了。打电话问过同学，他们跑到了兰坪路上一家叫自由港的KTV去K歌了。赶快从校门口拉了部QQ去那里。过去一看，结果还没有开始唱呢……嘿嘿，赶上去猥琐了番（不过没有贱人和老大两个猥琐），喝了点饮料（失误……），然后五点多接到荷马的短信，说要初中同学聚会，改在了晚上。嗯，地点在……还是“小尾羊”！
靠，我过去的时候，眼睛都不知道往哪里看。总觉得很尴尬。中午刚刚撮完，晚上又跑过去……有没有搞错？然后席上吃了点就over了，都不知道该怎么吃，中午实在吃的太饱了。不过吃东西的前段时间是大家抢啊，后面就是……谁吃啊，谁吃啊……看来大家近几天吃的都很辛苦。
聊了聊，发现有三个要出国的，N多准备出国的，还有e的N方多已经在国外的我认识不认识的大牛。怎么大家都往外跑啊……GiGi也是……小姚也是……老鼠也是……靠……都知道我外语不好。算了，自立自强，坚持自学计算机……
对了对了，先记录下来。鸡问了一个DB的问题，如何放置大规模二进制数据。现在估计下来是读写不正确，回头问问他加没有效验返回值和错误状态。还有要了所有同学的手机号码（嘿嘿……），可怜了我的手机卡。希望所有我加了MSN的friends看到本页的时候不要生气，不要惊讶，嘿嘿。
最后本来准备去物理王老师家玩的，结果发现不在家。然后商量怎么回去。鸡说他有车，我们大喜过望。然后他悠闲的补了句……不过要半个钟头……吐血ing。好你个鸡，回头我碰得到电脑了，整死你……！@#￥％^&amp;×（。罢也罢也，就凑合坐个徐闵线吧。最后和顾功坤李白璐杨卿边聊边晃到车站，坐车回家。发现两个广电的都不知道我认识甄小璐……明明路上都会打招呼的说。真是……怪事天天有，毕业特别多。算了，不计较这个问题了，赶快上地铁吧，我热死了。哎，今天还真有意思，不过还是家里舒服。
最后地铁上，小方个家伙打过来问我要不要去养思亭。本来挺好的，我四年都没有去过说。（记得找个时间去次，否则抱憾终身，初中就没有去过，都十年了）但是很遗憾，我都在地铁上了。还因为把这个答案吼回给小方差点没有下车。我!@#$%^&amp;*()_+}{&rdquo;:?</p>

          

        

    </article>
    
    <article>

        
        

<header>
    <p class="meta">Jun 23, 2005
         - 1 minute read 
         - <a href="http://blog.shell909090.org/blog/archives/181/#disqus_thread">Comments</a>

        
    </p>
    <h1 class="entry-title">
        <a href="http://blog.shell909090.org/blog/archives/181/">KaKa的家</a>
    </h1>
</header>


        
          <p>昨天KaKa带我们去了她的家，我们终于见到了传说中的KaKa的父亲。果然能喝，居然要求男生两杯女生一杯，点名要求我三杯。幸好后来有事，把这个事情给揭了过去，否则我就回不来了……
对KaKa家的第三印象，好大，第二印象，环境好漂亮，第一印象，蚊子好多……晚上睡觉的时候没有被子也没有枕头，放我们在外面就是喂蚊子的。幸好小费买了瓶蚊补丁，打上后果然稳定多了……不是不是……是蚊子少多了。早上给大班叫起来，发现三个女生通宵到七点半。汗……好恐怖的精力，贝壳是困了就要睡觉了。
孙大班的家啥都好，就是路远了点（当然，蚊子也多了点……）。从学校过去是两个多钟头，偶跑回自己家又用了两个钟头，加上去学校的两个钟头，可以证明，三者形成等边三角型。贝壳出来的时候，孙大班还特意嘱咐在对面乘车。结果贝壳是属蚂蚁的，先爬会熟悉的地头，再走熟悉的路线。特意开回南汇，然后一部班车到家。省却不少麻烦，就是乘车时间稍微长了点。
昨天晚上喝酒当中不知道怎么提到的（好像是杨文卓喝酒不喝酒弄出来的），袁乐突然发神经，要在毕业一周内结婚，预定时间是七月一号，因为是党的生日。各位各位，如果我们全班没有被耍的话，七一贝壳就要去重庆玩两天了。虽然临近答辩，老师催的很紧的说。这些都不重要，但是……但是……但是我的钱包啊……负债已经一千五百了，再下去毕业前就要预支一个月的薪水了。</p>

          

        

    </article>
    
    <article>

        
        

<header>
    <p class="meta">Jun 19, 2005
         - 1 minute read 
         - <a href="http://blog.shell909090.org/blog/archives/180/#disqus_thread">Comments</a>

        
    </p>
    <h1 class="entry-title">
        <a href="http://blog.shell909090.org/blog/archives/180/">大教堂</a>
    </h1>
</header>


        
          <p>很久以前就听过巴利奥斯的大教堂，不过一直都不知道叫什么。（相信大家也听过吧，尤其是男生，CS中某关在教堂附近的音乐……）然后，我学了吉他，知道了名字。不过很抱歉也很遗憾，我弹不来。嘿嘿，好像我有点懒……
不过大教堂的却也够难……不但技术上要求技巧高，弹奏速度快，而且持续时间超长。技术差点，不是弹不出来，就是断断续续，或者根本弹不完。开始的时候就要用拇指食指中指交替快速弹奏，我现在连这段都无法连贯弹出来。看来弹完它这个梦想是终身无望了……
大教堂给人的感觉有点庄严不是那么特别的庄严。每次烦躁的时候听，心里面都会平静下来。但是静心仔细听，又给我一种蠢蠢欲动的感觉。上跳下窜的音符引发隐约的躁动，仿佛要发生什么，又什么都不会发生。每个走向都非常出人意料，就像人生，你永远不知道下一刻你会得到什么。</p>

          

        

    </article>
    
    <article>

        
        

<header>
    <p class="meta">Jun 18, 2005
         - 1 minute read 
         - <a href="http://blog.shell909090.org/blog/archives/179/#disqus_thread">Comments</a>

        
    </p>
    <h1 class="entry-title">
        <a href="http://blog.shell909090.org/blog/archives/179/">blogs</a>
    </h1>
</header>


        
          <p>今天觉得MSNSpace还不错，呃，我没有在做广告。刚刚发现上面可以加入音乐列表和图书列表……虽然这些都需要外置空间的支持，不过，it&rsquo;s better then nothing。今天加了五首动漫曲和六首吉他曲。回头再改。我实在无法在更改IP的时候更换太多的URL的IP。也许我真的应该申请一个虚拟域名了。
OK，最近还不错，除了昨天晚上发神经的和real抱怨了通中国的软件业，还有和Gigi抱怨了通女人和结婚。其余一切OK，在此谢谢Gigi和real。
另外，最近开始分析NTFS格式了，看了MFT的说明，不过好头晕。现在下了一个linux内核中附带的NTFS解析部分在看。呵呵，也许我应该先吧前面的想法搞定，不是吗？不过现在不管这些了。反正我只是在玩电脑，快乐就好。也许几年后，连我自己都会忘记曾经有这么天，我在小小的房间里面，独自研究着NTFS。不过谁在意呢，千百年后，我们中的多少还能留下名字？与其将生命浪费在无谓的虚妄中，我更宁可做点现在就可以快乐的事情。而电脑，就是其中之一。
今天下了BitComet0.59用，终于支持用户列表交换和DHT了。感觉真好。不能不说，BC是目前国产软件中最有活力的一个。不是说推出的速度和宣传，而是各个软件的方面。例如支持XML，支持多语言扩展，各种新技术（像UDP内网穿越），广告，内嵌浏览器，内核定制和重用。让我想起以前的netant，winamp等等软件，充满了活力。也许软件维持活力和生命的关键，在于不断引入新鲜血液，并且加入市场来活化它。可能在几年后，现在BC的缔造者会成为将来的网络新贵。不过现在一切都还未知。</p>

          

        

    </article>
    
    <article>

        
        

<header>
    <p class="meta">Jun 13, 2005
         - 1 minute read 
         - <a href="http://blog.shell909090.org/blog/archives/178/#disqus_thread">Comments</a>

        
    </p>
    <h1 class="entry-title">
        <a href="http://blog.shell909090.org/blog/archives/178/">抱怨</a>
    </h1>
</header>


        
          <p>吃了人家的免费午餐，照例应该专程为人做做广告，致致贺词。不济也不应该抱怨连连。不过MSN的空间的却引我腹诽。过去的文章找不到……不知道是我方法不对还是什么。如果真的如此我干脆另觅它处，好过我珍贵的文章白白无人看……
OK，先放下MSN空间的问题吧。本周我分析了UPX的压缩原理分析结果亦不外如是。不过话说回来UPX毕竟不是专业的防跟踪壳，仅仅是资源压缩程序而已。好分析也没有什么值得意外的。
源程序如下，是最最出名的Hello,World.：
#include &quot;stdafx.h&quot; #include &lt;windows.h&gt; #pragma comment(linker, &quot;/ENTRY:main&quot;) //#pragma comment(linker, &quot;/ALIGN:0x1000&quot;)//这厮一上程序就变成3k党了，然后UPX就死气活样的不肯工作 #define put(x) WriteFile(hOutput, (x), sizeof(x), &amp;amp;NumOfBytes, NULL) #define get(x) ReadFile(hInput, (x), sizeof(x), &amp;amp;NumOfBytes, NULL) HANDLE hOutput, hInput; DWORD NumOfBytes; void main(){ char tmp[1]; hOutput=GetStdHandle(STD_OUTPUT_HANDLE); hInput=GetStdHandle(STD_INPUT_HANDLE); put(&quot;Hello,World.n&quot;); get(tmp); return ; }  UPX压缩下来的程序，section会变成三个。UPX0,UPX1,UPX2。其中UPX0是虚段，具备实际的段名称和段地址，但是RawDateSize是0。所以这个段在载入后是全0数据。数据和解压代码合并在了UPX1段中，由UPX1的解压代码注入UPX0的段中。看样子解压代码是附在了最后，从入口点到段实际内容结束点之间的范围。而UPX3的段最是搞笑，是一个单独的ImportTable，仅仅导入了Kernel32.dll中ExitProcess,LoadLibrary和GetProcessAddr三个函数。UPX1在解压并且注入UPX0后，会调用这三个函数来分析和获得每个导入表项的地址，然后完成导入表的动作。
换言，程序在从UPX1段JMP入UPX0段的瞬间，从UPX0段DUMP出来的数据就是正常的数据，除了要重建Section，并且重建所有DateDirectory外。
OK，下面说说压缩算法的问题。上面可以看出，压缩动作不难，但是算法我可没有能力分析和实现。所以我脑筋就动到了zip算法上去。可是根据我以前看zip文档得到的经验，zip内部分多种格式。貌似rar也分多种格式。所以我不打算挑战极限，自行写出每种算法的代码。不过我打算做一个标准的扩展接口，可以让所有的压缩算法都容纳在这一个框架内。并且可以支持多种压缩文件的格式。对上可以封装成标准的文件读写函数，然后再写一个COM组件，让所有的人都可以任意的运用（嘿嘿，写网页的人估计最需要）。至于后面要不要写一个什么东西让整个windows可以把压缩文件无缝的当成文件夹处理，那就再说了。</p>

          

        

    </article>
    
    <article>

        
        

<header>
    <p class="meta">Jun 8, 2005
         - 1 minute read 
         - <a href="http://blog.shell909090.org/blog/archives/177/#disqus_thread">Comments</a>

        
    </p>
    <h1 class="entry-title">
        <a href="http://blog.shell909090.org/blog/archives/177/">babylon</a>
    </h1>
</header>


        
          <p>真TMD麻烦，从网络上下了一个babylon。上了破解补丁，然后发现不能安装词库。安装词库就会出现授权无效，然后八天一过就用不了了。毛主席说，自己动手，丰衣足食。拿出OllyDbg拆开研究看看。反正补丁的类型是文件改写型，不用担心太麻烦。
不过我还是低估了babylon的难度，从昨天晚上到今天下午，经过将近一天的努力，我还是绕在babylon里面出不来。关键是我找到了显示判别无效的代码，但是在附近没有找到判别代码。NND原来他的判别代码在很久以前执行的，然后放在全局变量里面。害的我好找。然后发现判别代码分了两部分，一个是判断是否有效，一个是判断是否过期。经过一天的修改，还是没有发现过期代码的识别。不过幸好后来想到有一个现成的key，只是因为词典安装太多给识别成无效。这个好解决的很，前面的判别自动判断为有效就好了。然后跟踪后发现修改一个字节就可以暂时解决这个问题。不错不错。
然后是写补丁的问题，我上了一个原来的补丁壳子。发现这个补丁壳子实在奇怪，明明写的是8，却按照B去编译，结果修改地址错误了，导致破解失败。更倒霉的是程序把备份文件的名字起的和网络上的补丁一样，结果按照补丁规则默认覆盖了。闹的我连原始文件都没有了……不得以只好将现在的程序备份重新安装，然后提取出一个主文件来。看来不重新写一个补丁壳子不行了，这次写的完美点……</p>

          

        

    </article>
    
    
    




<div class="pagination">

    
        
        
        
        <a href="/" aria-label="First" class="label-pagination"><i class="fa fa-angle-double-left fa-lg"></i></a>
    

    
    
        <a href="/page/90/" aria-label="Previous" class="label-pagination"><i class="fa fa-angle-left fa-lg"></i></a>
    

    
        <a href="/" class="label-pagination">1</a>
    
        <a href="/page/2/" class="label-pagination">2</a>
    
        <a href="/page/3/" class="label-pagination">3</a>
    
        <a href="/page/4/" class="label-pagination">4</a>
    
        <a href="/page/5/" class="label-pagination">5</a>
    
        <a href="/page/6/" class="label-pagination">6</a>
    
        <a href="/page/7/" class="label-pagination">7</a>
    
        <a href="/page/8/" class="label-pagination">8</a>
    
        <a href="/page/9/" class="label-pagination">9</a>
    
        <a href="/page/10/" class="label-pagination">10</a>
    
        <a href="/page/11/" class="label-pagination">11</a>
    
        <a href="/page/12/" class="label-pagination">12</a>
    
        <a href="/page/13/" class="label-pagination">13</a>
    
        <a href="/page/14/" class="label-pagination">14</a>
    
        <a href="/page/15/" class="label-pagination">15</a>
    
        <a href="/page/16/" class="label-pagination">16</a>
    
        <a href="/page/17/" class="label-pagination">17</a>
    
        <a href="/page/18/" class="label-pagination">18</a>
    
        <a href="/page/19/" class="label-pagination">19</a>
    
        <a href="/page/20/" class="label-pagination">20</a>
    
        <a href="/page/21/" class="label-pagination">21</a>
    
        <a href="/page/22/" class="label-pagination">22</a>
    
        <a href="/page/23/" class="label-pagination">23</a>
    
        <a href="/page/24/" class="label-pagination">24</a>
    
        <a href="/page/25/" class="label-pagination">25</a>
    
        <a href="/page/26/" class="label-pagination">26</a>
    
        <a href="/page/27/" class="label-pagination">27</a>
    
        <a href="/page/28/" class="label-pagination">28</a>
    
        <a href="/page/29/" class="label-pagination">29</a>
    
        <a href="/page/30/" class="label-pagination">30</a>
    
        <a href="/page/31/" class="label-pagination">31</a>
    
        <a href="/page/32/" class="label-pagination">32</a>
    
        <a href="/page/33/" class="label-pagination">33</a>
    
        <a href="/page/34/" class="label-pagination">34</a>
    
        <a href="/page/35/" class="label-pagination">35</a>
    
        <a href="/page/36/" class="label-pagination">36</a>
    
        <a href="/page/37/" class="label-pagination">37</a>
    
        <a href="/page/38/" class="label-pagination">38</a>
    
        <a href="/page/39/" class="label-pagination">39</a>
    
        <a href="/page/40/" class="label-pagination">40</a>
    
        <a href="/page/41/" class="label-pagination">41</a>
    
        <a href="/page/42/" class="label-pagination">42</a>
    
        <a href="/page/43/" class="label-pagination">43</a>
    
        <a href="/page/44/" class="label-pagination">44</a>
    
        <a href="/page/45/" class="label-pagination">45</a>
    
        <a href="/page/46/" class="label-pagination">46</a>
    
        <a href="/page/47/" class="label-pagination">47</a>
    
        <a href="/page/48/" class="label-pagination">48</a>
    
        <a href="/page/49/" class="label-pagination">49</a>
    
        <a href="/page/50/" class="label-pagination">50</a>
    
        <a href="/page/51/" class="label-pagination">51</a>
    
        <a href="/page/52/" class="label-pagination">52</a>
    
        <a href="/page/53/" class="label-pagination">53</a>
    
        <a href="/page/54/" class="label-pagination">54</a>
    
        <a href="/page/55/" class="label-pagination">55</a>
    
        <a href="/page/56/" class="label-pagination">56</a>
    
        <a href="/page/57/" class="label-pagination">57</a>
    
        <a href="/page/58/" class="label-pagination">58</a>
    
        <a href="/page/59/" class="label-pagination">59</a>
    
        <a href="/page/60/" class="label-pagination">60</a>
    
        <a href="/page/61/" class="label-pagination">61</a>
    
        <a href="/page/62/" class="label-pagination">62</a>
    
        <a href="/page/63/" class="label-pagination">63</a>
    
        <a href="/page/64/" class="label-pagination">64</a>
    
        <a href="/page/65/" class="label-pagination">65</a>
    
        <a href="/page/66/" class="label-pagination">66</a>
    
        <a href="/page/67/" class="label-pagination">67</a>
    
        <a href="/page/68/" class="label-pagination">68</a>
    
        <a href="/page/69/" class="label-pagination">69</a>
    
        <a href="/page/70/" class="label-pagination">70</a>
    
        <a href="/page/71/" class="label-pagination">71</a>
    
        <a href="/page/72/" class="label-pagination">72</a>
    
        <a href="/page/73/" class="label-pagination">73</a>
    
        <a href="/page/74/" class="label-pagination">74</a>
    
        <a href="/page/75/" class="label-pagination">75</a>
    
        <a href="/page/76/" class="label-pagination">76</a>
    
        <a href="/page/77/" class="label-pagination">77</a>
    
        <a href="/page/78/" class="label-pagination">78</a>
    
        <a href="/page/79/" class="label-pagination">79</a>
    
        <a href="/page/80/" class="label-pagination">80</a>
    
        <a href="/page/81/" class="label-pagination">81</a>
    
        <a href="/page/82/" class="label-pagination">82</a>
    
        <a href="/page/83/" class="label-pagination">83</a>
    
        <a href="/page/84/" class="label-pagination">84</a>
    
        <a href="/page/85/" class="label-pagination">85</a>
    
        <a href="/page/86/" class="label-pagination">86</a>
    
        <a href="/page/87/" class="label-pagination">87</a>
    
        <a href="/page/88/" class="label-pagination">88</a>
    
        <a href="/page/89/" class="label-pagination">89</a>
    
        <a href="/page/90/" class="label-pagination">90</a>
    
        <a href="/page/91/" class="label-pagination">91</a>
    
        <a href="/page/92/" class="label-pagination">92</a>
    
        <a href="/page/93/" class="label-pagination">93</a>
    

    
    
        <a href="/page/92/" aria-label="Next" class="label-pagination"><i class="fa fa-angle-right fa-lg"></i></a>
    

    
    
        <a href="/page/93/" aria-label="Last"><i class="fa fa-angle-double-right fa-lg"></i></a>
    

</div>

  

  </div>

  

<aside class="sidebar thirds">
  <section class="first odd">

    

    <p>
      
    </p>
  </section>



  
  <ul class="sidebar-nav">
    <li class="sidebar-nav-item">
      
      
      
      
       
      
      
      
      
      
      

    
    
    </li>
  </ul>

  

  

  
  
  
    
      <section class="even">
        <h1>Recent Posts</h1>
        <ul id="recent_posts">
          
            <li class="post">
              <a href="/blog/archives/2857/">Boracay潜水攻略</a>
            </li>
          
            <li class="post">
              <a href="/blog/archives/2856/">golang安装和编译环境搭建</a>
            </li>
          
            <li class="post">
              <a href="/blog/archives/2855/">法国游记</a>
            </li>
          
            <li class="post">
              <a href="/blog/archives/2854/">使用Debian作为Router</a>
            </li>
          
            <li class="post">
              <a href="/blog/archives/2853/">riot.im简介</a>
            </li>
          
            <li class="post">
              <a href="/blog/archives/2852/">Puerro Galera游记</a>
            </li>
          
            <li class="post">
              <a href="/blog/archives/2851/">/proc/net/dev中bonding网卡的流量计算</a>
            </li>
          
            <li class="post">
              <a href="/blog/archives/2850/">SI的七个基础单位</a>
            </li>
          
            <li class="post">
              <a href="/blog/archives/2849/">模拟网络丢包延迟和TC的使用</a>
            </li>
          
            <li class="post">
              <a href="/blog/archives/2848/">两台机器上TCP状态不一致的排查</a>
            </li>
          
        </ul>
      </section>
    
  

</aside>
    
 </div>
</div>

<footer role="contentinfo">
  <p>Copyright &copy; 2017 Shell Xu - <a href="http://blog.shell909090.org/license/">License</a> -
  <span class="credit">Powered by <a target="_blank" href="https://gohugo.io">Hugo</a> and <a target="_blank" href="https://github.com/parsiya/hugo-octopress/">Hugo-Octopress</a> theme.
</p>

</footer>


</body>
</html>
   
