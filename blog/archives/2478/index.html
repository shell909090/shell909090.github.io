<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1">

  
  <link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <title>青旅无线组网指南</title>

  
  
  <link rel="stylesheet" href="http://shell909090.org/css/hugo-octopress.css">

  
  

  
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

  
  <link href="http://shell909090.org/favicon.png" rel="icon">

  
  
  

  

  <meta name="description" content="">
  <meta name="keywords" content="">

  <meta name="author" content="">

  
  <meta name="generator" content="Hugo 0.17-DEV" />

  
  
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-48816091-1', 'auto');
ga('send', 'pageview');
</script>


</head>
<body>


<header role="banner"><hgroup>
  
  <h1><a href="http://shell909090.org/">Shell&#39;s Home</a></h1>
    <h2></h2>
</hgroup></header>


<nav role="navigation">

<ul class="main-navigation">
  
  
</ul>


<ul class="subscription">
  

  
  

</ul>


</nav>


<div id="main">
  <div id="content">
    <div>
      <article class="hentry" role="article">

        
        

<header>
    <h1 class="entry-title">
         青旅无线组网指南 
    </h1>
    <p class="meta">Sep 12, 2013
         - 1 minute read 
         - <a href="http://shell909090.org/blog/archives/2478/#disqus_thread">Comments</a>

        
    </p>
</header>


        <div class="entry-content">
          
          
          
          <p>本文不仅适用于青旅，还包括其他人员密集的场所，通过无线方式进行最低限度的上网。例如公司。</p>

<p>会写这篇，主要是旅行过程中，发现网络状况实在无法接受。像阿里地区这种没信号的区域就算了，在很多青旅里也因为种种原因上网不畅，实在让人很不爽。所以写一篇guide出来，说明一下各种问题。</p>

<h1>容量估算</h1>

<p>首先，你必须估计在一定范围内需要联网的设备数。一般来说，就是某个无线覆盖范围的人员数乘以1.2到2不等的系数。如果是青旅，大概乘1.2就足够了。因为很多出来玩的人只带手机，偶尔会带ipad。但是在公司，一般至少到2。因为有很多人会将笔记本和手机同时连接上网络。</p>

<p>每个设备连入网络，就会占用三样东西，IP地址，带宽和AP连接数。</p>

<p>IP地址一般问题不大，只要同时连入网络的设备数不超过200台，就可以塞到一个C类子网里。但是注意，这时候DHCP的空间要足够。</p>

<p>带宽的计算上，一般一个手机按照5KB算，一个电脑要10KB以上。粗略点可以将设备数乘以40kbps，得到所需的带宽。</p>

<p>AP连接数就是每个设备算一个。</p>

<p>例如，在某个青旅的大厅里，巅峰时刻可以坐下15个人。这时候，设备数估计是15*1.2=18台。带宽估计是720kbps，AP连接数18。</p>

<h1>限制</h1>

<p>容量估算有什么意义呢？主要就是决定你租用电信带宽的大小和选用路由器的质量和数量。带宽都懂，主要说一下路由器的质量和数量。</p>

<p>可能很多非专业人士不知道，路由器能够同时在线的终端数量是有限的。这个叫做AP的待机数。超过这个数字有的路由器也许还能接入几个，但是就开始各种不稳定了。例如TPLINK的TP703N，待机数就是8。同时接入8个设备问题不大，再多就不好说了。而TPLINK的一般路由器，待机数都在10-15之间。企业级的最高可以达到32（WVR450G），但是价格高达500多，也不合算。</p>

<p>很多青旅的问题在于，明明申请了一根很大的线路，但是却随便的弄了一个路由器。当人都集中到大厅里的时候，路由器待机数马上不足了，很多用户连都连不上去。由于智能手机的普及，这个现象正越来越明显。在旅行中我几次用自己的路由器，用网线连接到主路由器上。在别人羡慕嫉妒恨的眼神里面老神在在的上网，就是这个原因。</p>

<p>个人推荐使用TL-WDR3320。一方面他的待机数是20，不算低，价格只有200左右（京东价）。另一方面这台设备还支持5G网段，可以让支持5G的设备通过5G网段接入（例如苹果的设备），而不占用2.4G的宝贵频道。两台合起来，比WVR450G要支持更多，而且更便宜。当然，这种替换是有代价的，其缺点就是滥用了频道，可能造成频道管理上的困难，我们稍后再说。</p>

<p>继续上面的例子，大厅里18台设备，那么就可以用一台TL-WDR3320搞定。</p>

<h1>覆盖</h1>

<p>在计算完容量后，我们复杂的网络设计之路才刚刚开始。记得我上面强调过一个词，一定范围内需要联网的设备。这个词的意思是，如果人员分布在了各个角落，你需要独立计算无线覆盖。</p>

<p>很多青旅的问题在于，压根没有考虑无线的覆盖性，就在中央大厅拉了一个路由器了事。结果一帮驴子半夜三更不睡觉在大厅里刷手机刷明天的线路。。。</p>

<p>关于无线的覆盖，是一个挺复杂的问题。简单点的解法是在android手机上下一个wifi analyse软件。然后选个你觉得OK的点，把AP接上电（不用联网）。用软件可以看到AP的信号强度。然后来回走动一下，看看是不是每个位置都能保持70dbm左右的信号。如果不行，再换点。</p>

<p>还是上面那个例子。大厅里面15个人，但是在住宿区域分为三个部分，每个部分三间房，第一，二部分每个房间4张床，第三部分每个房间6张床。</p>

<p>首先带宽就要重算。第一，二部分都是15台设备（三间房x四张床x1.2），第三部分22台设备（三间房x六张床x1.2），总计52台设备，2080kbps。也就是至少2M的网络，建议申请4M。</p>

<p>注意这里算的时候不要重复加大厅的人了，一个人要么在大厅里要么在房间里，一般不会同时在。</p>

<p>其次，大厅，每个部分都要分别装一台TL-WDR3320，总共4台。其中第三部分的待机数略不足。好心的可以补一个WR703N补足，没这个闲功夫的就赌房间不会总是客满吧。</p>

<h1>频道分配</h1>

<p>这个就是更细节的问题了。</p>

<p>记住几点，wifi有11个频道可用，其中间隔5以上的没干扰。所以一般1,6,11不互相干扰。</p>

<p>当然，相邻的两个AP最好不要用互相干扰的频道。</p>

<p>所以你就知道，如果大厅人数多，只用一个WVR450G会在频道分配上好算很多。如果是两台AP，就比较难管理了。</p>

<p>刚刚的例子继续，把频道6分给离的最远的两台AP，就保证4台设备互相不冲突了。如果补了WR703N，那么就分配一个合适的频道吧。</p>

<h1>连接结构</h1>

<p>上面讲了半天如何计算需要几个AP，布在什么点。现在讲一下如何连接。</p>

<p>简单来说，就是用每个AP的LAN口拉一条网线出来，接到其他AP的LAN口就成。这样就能保证AP的彼此相连。至于彼此间是用星型，都接到一个AP上。还是用线型，一路AP一个接一个接出去，都可以。只要别接出环来就好。有的AP不支持STP协议，接出环就会无法工作。</p>

<p>最后，再把外网网线插到某个AP的WAN口，搞定。</p>

<p>插入WAN的路由被称为主路由。一般来说，如果用户数大于100，主路由需要足够强才行。如果TL-WDR3320不够，还是要一台WVR450G。</p>

<h1>配置</h1>

<p>一般路由器都是192.168.1.1，然后打开DHCP。当使用上面说的这种配置结构的时候，就不能这么配了。</p>

<p>你首先要将主路由配置为192.168.1.1，其他路由的LAN口依次配置为1.2 1.3等等。然后关闭其他路由器的DHCP功能，并为每个路由器分配合适的频道。</p>

<p>如果网络不需要保密，建议配置为随意连接，待机数还可以增加一些。但是一般这样会惹来大量蹭网的，所以一般需要将安全设定为WPA2。所有AP设定为一样的名字和密码，设备会自动寻找信号最强的那个。</p>

<p>如果用的是TL-WDR3320，那么还要注意分别配置2.4G和5G频段。建议2.4G和5G选用不同的名字，但是可以用一样的密码。这样用户可以自行选择是使用2.4G网络还是5G网络。</p>

<h1>细节</h1>

<p>有空的话，可以看一下我这篇<a href="http://shell909090.org/blog/2011/09/%E5%90%88%E7%94%A8%E4%B8%A4%E4%B8%AA%E8%B7%AF%E7%94%B1%E5%99%A8%E7%9A%84%E5%87%A0%E7%A7%8D%E6%96%B9%E6%A1%88/">合用两个路由器的几种方案</a></p>

        </div>
        

<footer>
  <p class="meta">
    <span class="byline author vcard">Posted by <span class="fn"></span></span>
    
    <time>Sep 12, 2013</time>
    <span class="categories">
      Tags:
        
        
          <a class="category" href="http://shell909090.org/tags/computer">computer</a>  
        
    </span>
  </p>

  
  

  

  <p class="meta">
    
        <a class="basic-alignment left" href="http://shell909090.org/blog/archives/2476/" title="西藏行——第五天（纳木错）">西藏行——第五天（纳木错）</a>
    

    
      <a class="basic-alignment right" href="http://shell909090.org/blog/archives/2483/" title="西藏行——第六到八天（拉萨）">西藏行——第六到八天（拉萨）</a>
    
  </p>
  
    
      <div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'shell909090blog';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    
  
</footer>

      </article>
    </div>
    

<aside class="sidebar thirds">
  <section class="first odd">

    

    <p>
      
    </p>
  </section>



  
  <ul class="sidebar-nav">
    <li class="sidebar-nav-item">
      
      
      
       
      
      
      
      
      

    
    
    </li>
  </ul>

  

  

  
  
  
    <section class="even">
      <h1>Recent Posts</h1>
      <ul id="recent_posts">
        
          <li class="post">
            <a href="/blog/archives/2839/">CentOS 6下安装Python2.7</a>
          </li>
        
          <li class="post">
            <a href="/blog/archives/2838/">gpg pubkey ID碰撞</a>
          </li>
        
          <li class="post">
            <a href="/blog/archives/2837/">更换blog声明</a>
          </li>
        
          <li class="post">
            <a href="/blog/archives/2836/">Pulau Perhentian</a>
          </li>
        
          <li class="post">
            <a href="/blog/archives/2835/">唐僧被吃了</a>
          </li>
        
          <li class="post">
            <a href="/blog/archives/2832/">三亚潜水体验</a>
          </li>
        
          <li class="post">
            <a href="/blog/archives/2829/">潜水的一些简单解说</a>
          </li>
        
          <li class="post">
            <a href="/blog/archives/2822/">一个有趣的问题</a>
          </li>
        
          <li class="post">
            <a href="/blog/archives/2820/">一次升级故障的排查</a>
          </li>
        
          <li class="post">
            <a href="/blog/archives/2816/">关于程序员和产品经理两大世界体系的对话——论快播庭审</a>
          </li>
        
      </ul>
    </section>
  

</aside>

  </div>
</div>

<footer role="contentinfo">
  <p>Copyright &copy; 2016  - <a href="http://shell909090.org/license/">License</a> -
  <span class="credit">Powered by <a target="_blank" href="https://gohugo.io">Hugo</a> and <a target="_blank" href="https://github.com/parsiya/hugo-octopress/">Hugo-Octopress</a> theme.
</p>

</footer>


</body>
</html>

